/*
===============================================================================
Magnitude Analysis
===============================================================================
Purpose:
    - To quantify data and group results by specific dimensions.
    - For understanding data distribution across categories.
===============================================================================
*/

-- Find total customers by countries
select country, 
       count(customer_key) as total_customers
from gold.dim_customers
group by country
;

-- Find total customers by gender
select gender, 
       count(customer_key) as total_customers
from gold.dim_customers
group by gender;

-- Find total products by category
select category,
       count(product_key) as total_products
from gold.dim_products
group by category;

-- What is the average costs in each category?
select category, 
       avg(cost) avg_cost
from gold.dim_products
group by category;

-- What is the total revenue generated for each category?
select category,
       sum(sales_amount) total_revenue_generated
from gold.dim_products p
join gold.fact_sales f
 on p.product_key=f.product_key
group by category;


-- What is the total revenue generated by each customer?
select c.customer_key,
       c.first_name,
       c.last_name,
	   sum(sales_amount) as total_revenue
from gold.dim_customers c
join gold.fact_sales f 
  on c.customer_key=f.customer_key
group by c.customer_key, c.first_name, c.last_name;

-- What is the distribution of sold items across countries?
select country,
       sum(quantity) total_sold_items
from gold.fact_sales f
join gold.dim_customers c
  on f.customer_key=c.customer_key
group by country;
